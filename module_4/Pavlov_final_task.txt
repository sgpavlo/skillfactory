SELECT 
        f.flight_id,
        SUM(b.total_amount) AS revenue_sum
FROM    dst_project.flights f
        JOIN dst_project.boarding_passes bp ON f.flight_id = bp.flight_id
        JOIN dst_project.tickets t ON bp.ticket_no = t.ticket_no
        JOIN dst_project.bookings b ON t.book_ref = b.book_ref
WHERE f.departure_airport = 'AAQ'
  AND (date_trunc('month', f.scheduled_departure) in ('2017-01-01','2017-02-01', '2017-12-01'))
  AND f.status not in ('Cancelled')
GROUP BY f.flight_id
ORDER BY 2